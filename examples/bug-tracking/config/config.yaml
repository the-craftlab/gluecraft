# ============================================================================
# Bug Tracking Example
# ============================================================================
#
# Use Case: Simple bug tracking workflow with severity levels
# 
# This example demonstrates:
# - Bug-focused workflow (New → Triaged → Fixed → Verified)
# - Severity levels mapped to GitHub labels
# - Affected version tracking
# - Reporter/assignee management
# - Fast triage and resolution tracking
#
# Perfect for: Development teams managing bugs and technical issues
# ============================================================================

sync:
  direction: bidirectional
  jql: 'project = BUGS AND type = "Bug"'  # Only sync bugs
  # poll_interval: "*/10 * * * *"  # Every 10 minutes for quick response

# ============================================================================
# FIELD MAPPINGS
# ============================================================================
mappings:
  # Basic fields
  - jpd: "fields.summary"
    github: "title"
  
  - jpd: "fields.description"
    github: "body"
  
  # Severity Level → Labels
  # Run: pnpm run discover-fields BUGS to find your severity field
  - jpd: "fields.customfield_SEVERITY.value"  # Replace SEVERITY with your field ID
    github: "labels"
    mapping:
      "Critical": "severity:critical"
      "High": "severity:high"
      "Medium": "severity:medium"
      "Low": "severity:low"
  
  # Affected Version → Label
  - jpd: "fields.customfield_VERSION.value"  # Replace VERSION with your field ID
    github: "labels"
    template: "version:{{value | slugify}}"
  
  # Bug Type/Category
  - jpd: "fields.customfield_BUGTYPE.value"  # Replace BUGTYPE with your field ID
    github: "labels"
    mapping:
      "Regression": "type:regression"
      "New Bug": "type:new-bug"
      "Performance": "type:performance"
      "Security": "type:security"
      "UI/UX": "type:ui-ux"

# ============================================================================
# STATUS MAPPINGS (Bug Workflow)
# ============================================================================
statuses:
  "New":
    github_state: open
    sync: true
  
  "Triaged":
    github_state: open
    sync: true
  
  "Fixed":
    github_state: open  # Keep open until verified
    sync: true
  
  "Verified":
    github_state: closed  # Close only when verified
    sync: true
  
  # Optional: Closed without fix
  "Won't Fix":
    github_state: closed
    sync: false  # Don't sync these

  "Duplicate":
    github_state: closed
    sync: false  # Don't sync these

# ============================================================================
# GITHUB → JIRA CREATION
# ============================================================================
# Allow developers to create bugs from GitHub issues
github_to_jpd_creation:
  enabled: true
  
  # Map GitHub labels to JIRA severity
  label_to_category:
    "bug": "Bug"  # Ensures GitHub "bug" label creates JIRA Bug type
  
  default_status: "New"
  default_category: "Bug"
  
  # Field mappings for creating bugs from GitHub
  field_mappings:
    category_field_id: "customfield_SEVERITY"  # Replace with your severity field ID

# ============================================================================
# FIELD DEFINITIONS
# ============================================================================
fields:
  - id: "customfield_SEVERITY"  # Replace with actual field ID
    name: "Severity"
    type: "select"
    required: true
    description: "Bug severity level"
  
  - id: "customfield_VERSION"  # Replace with actual field ID
    name: "Affected Version"
    type: "text"
    required: false
    description: "Version where bug was found"
  
  - id: "customfield_BUGTYPE"  # Replace with actual field ID
    name: "Bug Type"
    type: "select"
    required: false
    description: "Category of bug"

# ============================================================================
# GITHUB LABELS (Auto-Created)
# ============================================================================
# Labels are automatically created the first time they're used
# Pre-create all labels with: pnpm run setup-labels
labels:
  types:
    - name: "type:regression"
      color: "FF5630"
      description: "Regression bug"
    - name: "type:new-bug"
      color: "DE350B"
      description: "New bug"
    - name: "type:performance"
      color: "FF8B00"
      description: "Performance issue"
    - name: "type:security"
      color: "FF0000"
      description: "Security vulnerability"
    - name: "type:ui-ux"
      color: "6554C0"
      description: "UI/UX bug"
  
  # Severity labels (from Severity field)
  custom:
    - name: "severity:critical"
      color: "DE350B"
      description: "Critical severity - production down"
    - name: "severity:high"
      color: "FF8B00"
      description: "High severity - major impact"
    - name: "severity:medium"
      color: "FFC400"
      description: "Medium severity - moderate impact"
    - name: "severity:low"
      color: "8993A4"
      description: "Low severity - minor issue"
  
  # Example version labels (created dynamically from Affected Version field)
  # - name: "version:v1.0.0"
  #   color: "00B8D9"
  # - name: "version:v2.0.0"
  #   color: "00B8D9"

# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================
# 1. Run: pnpm run discover-fields BUGS
# 2. Replace customfield_XXXXX with your actual field IDs
# 3. Update severity/version/type mappings to match your values
# 4. Create labels: pnpm run setup-labels
# 5. Test with: CONFIG_PATH=examples/bug-tracking/config/config.yaml pnpm run dev -- --dry-run

