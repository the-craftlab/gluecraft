# JPD to GitHub Sync Configuration for MTT Test Project
# This is a MINIMAL config based on what's currently in the MTT project
# Expand this as you add more fields to your test project

sync:
  direction: "jpd-to-github"  # Start unidirectional, add bidirectional later
  
  # JQL filter - sync all MTT issues for now
  # Later, add status filters when you set up the workflow
  jql: "project = MTT"

# Map JPD fields to GitHub issue
mappings:
  # ==========================================
  # CORE FIELDS (Required)
  # ==========================================
  
  - jpd: "fields.summary"
    github: "title"
  
  - jpd: "fields.description"
    github: "body"
    transform_function: "./transforms/build-issue-body.ts"  # Custom function to create rich body
  
  # ==========================================
  # LABELS (Minimal, for filtering)
  # ==========================================
  
  # Dev Priority (execution priority for developers)
  # Options: critical, high, normal, low
  # If not set in JPD, will auto-derive from MoSCoW field if available
  - jpd: "."  # Pass whole issue to transform function
    github: "labels"
    transform_function: "./transforms/derive-priority.ts"

# ==========================================
# METADATA (Hidden in HTML comment)
# Store all JPD context for machine consumption
# ==========================================
metadata:
  jpd_fields:
    - theme            # customfield_14377
    - roadmap          # customfield_14378
    - category         # customfield_14385
    - impact           # customfield_14376
    - reach            # customfield_14379
    - value            # customfield_14386
    - effort           # customfield_14387
    - confidence       # customfield_14389
    - short_description # customfield_14388

# ==========================================
# GITHUB ISSUE BODY TEMPLATE
# What developers see when they open the issue
# ==========================================
body_template: |
  # {{jpd.summary}}
  
  {{#if jpd.short_description}}
  > {{jpd.short_description}}
  {{/if}}
  
  ## Context from Product
  
  **Theme**: {{jpd.theme}}  
  **Category**: {{jpd.category}}  
  **Roadmap**: {{jpd.roadmap}}
  
  ### Scoring (RICE)
  - **Reach**: {{jpd.reach}}
  - **Impact**: {{jpd.impact}}
  - **Confidence**: {{jpd.confidence}}%
  - **Effort**: {{jpd.effort}} points
  - **Value**: {{jpd.value}}
  
  ## Description
  
  {{jpd.description}}
  
  ## Links
  
  - [View in JPD]({{jpd.link}})
  
  ---
  <!-- jpd-sync-metadata: DO NOT EDIT BELOW THIS LINE
  {{metadata_json}}
  -->

# ==========================================
# STATUS MAPPING (Add when you set up workflow)
# ==========================================
# Uncomment and configure when you set up JPD workflow statuses
# 
# statuses:
#   # Don't sync these (PM-only phases)
#   skip_statuses:
#     - "Idea"
#     - "Discovery"
#     - "Icebox"
#   
#   # Sync these to GitHub
#   sync_statuses:
#     "Epic Design":
#       github_state: "open"
#       github_project_column: "üé® Design"
#       auto_labels: ["needs-design"]
#     
#     "Backlog":
#       github_state: "open"
#       github_project_column: "üìã Backlog"
#     
#     "Ready":
#       github_state: "open"
#       github_project_column: "üìù Ready"
#     
#     "In Progress":
#       github_state: "open"
#       github_project_column: "‚öôÔ∏è In Progress"
#     
#     "In Review":
#       github_state: "open"
#       github_project_column: "üëÄ In Review"
#     
#     "Done":
#       github_state: "closed"
#       github_project_column: "‚úÖ Done"

# ==========================================
# FIELD ID MAPPINGS
# Map friendly names to JPD custom field IDs
# ==========================================
field_mappings:
  theme: "customfield_14377"
  roadmap: "customfield_14378"
  category: "customfield_14385"
  impact: "customfield_14376"
  reach: "customfield_14379"
  value: "customfield_14386"
  effort: "customfield_14387"
  confidence: "customfield_14389"
  short_description: "customfield_14388"
  
  # Approval gates (add these to your test project when ready)
  # spec_ready: "customfield_14381"
  # designs_ready: "customfield_14382"
  
  # Strategic fields (add when ready)
  # customer_segments: "customfield_14380"
  # documents: "customfield_14390"
  # product_area: "customfield_14392"
  # rice_score: "customfield_14391"

# ==========================================
# FIELD VALIDATION
# Define required fields and their types
# The sync will validate these exist before starting
# ==========================================
fields:
  # Core RICE scoring fields
  - id: "customfield_14377"
    name: "Theme"
    type: "multiselect"
    required: true
    description: "Product theme (Expand horizons, etc.)"
  
  - id: "customfield_14378"
    name: "Roadmap"
    type: "select"
    required: true
    description: "Roadmap timeline (Now/Next/Later) - stays in JPD, not synced"
  
  - id: "customfield_14425"
    name: "Dev Priority"
    type: "select"
    required: false
    description: "GitHub execution priority (critical/high/normal/low)"
  
  # Optional: Create MoSCoW field for auto-derivation
  # - id: "customfield_YYYYY"
  #   name: "MoSCoW"
  #   type: "select"
  #   required: false
  #   description: "PM evaluation (Must/Should/Could/Won't have)"
  
  - id: "customfield_14385"
    name: "Category"
    type: "select"
    required: true
    description: "Idea category (Sample ideas, etc.)"
  
  - id: "customfield_14376"
    name: "Impact"
    type: "number"
    required: true
    description: "RICE Impact score"
  
  - id: "customfield_14379"
    name: "Reach"
    type: "number"
    required: true
    description: "RICE Reach score"
  
  - id: "customfield_14386"
    name: "Value"
    type: "number"
    required: true
    description: "RICE Value score"
  
  - id: "customfield_14387"
    name: "Effort"
    type: "number"
    required: true
    description: "RICE Effort score (story points)"
  
  - id: "customfield_14389"
    name: "Confidence"
    type: "number"
    required: true
    description: "RICE Confidence percentage"
  
  - id: "customfield_14388"
    name: "Idea Short Description"
    type: "text"
    required: false
    description: "Brief idea summary"

