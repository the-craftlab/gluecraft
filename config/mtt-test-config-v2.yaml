# MTT Test Project - Updated Configuration
# Based on actual JPD statuses

sync:
  direction: bidirectional
  poll_interval: '*/15 * * * *'
  jql: 'project = MTT'

# Field mappings
mappings:
  # Basic fields
  - jpd: "fields.summary"
    github: "title"

  # Rich body using custom function
  - jpd: "fields.description"
    github: "body"
    transform_function: "./transforms/build-issue-body.ts"

  # Clean labels - no prefixes, human-focused for filtering
  # Theme label (no prefix)
  - jpd: "fields.customfield_14377[0].value"
    github: "labels"
    template: "{{fields.customfield_14377[0].value | slugify}}"

  # Category label (no prefix)
  - jpd: "fields.customfield_14385.value"
    github: "labels"
    template: "{{fields.customfield_14385.value | slugify}}"

  # Dev Priority label (critical/high/normal/low)
  # Auto-derives from "Dev Priority" field, falls back to "normal"
  - jpd: "."
    github: "labels"
    transform_function: "./transforms/derive-priority.ts"

# Status mappings (based on actual MTT statuses)
statuses:
  # Ideas Phase (not synced)
  "Parking lot":
    github_state: open
  
  "Discovery":
    github_state: open

  # Epic Phase
  "Impact":
    github_state: open
    github_project_status: "ðŸ“Š Impact Assessment"

  # Story Phase  
  "Ready for delivery":
    github_state: open
    github_project_status: "âœ… Ready"

  "Delivery":
    github_state: open
    github_project_status: "ðŸš€ Delivery"

  # Completion
  "Done":
    github_state: closed
    github_project_status: "âœ… Done"

# Hierarchy (status-based)
hierarchy:
  # Define which statuses represent which hierarchy levels
  epic_statuses:
    - "Impact"  # Ideas in "Impact" status are Epics
  
  story_statuses:
    - "Ready for delivery"
    - "Delivery"
    - "Done"
  
  task_statuses: []

  # Label templates
  epic_label_template: "epic:{{epic.key}}"
  story_label_template: "story:{{story.key}}"
  
  parent_field_in_body: true
  use_github_parent_issue: true

# GitHub Projects (optional - disable for now)
projects:
  enabled: false
  project_number: 1
  status_field_name: "Status"

# Team management
teams:
  auto_detect: true
  epic_ownership: true

# ==========================================
# FIELD VALIDATION
# Validate these fields exist before syncing
# ==========================================
fields:
  # Core RICE scoring fields
  - id: "customfield_14377"
    name: "Theme"
    type: "multiselect"
    required: true
    description: "Product theme (Expand horizons, etc.)"
  
  - id: "customfield_14378"
    name: "Roadmap"
    type: "select"
    required: true
    description: "Roadmap priority (Now/Next/Later)"
  
  - id: "customfield_14385"
    name: "Category"
    type: "select"
    required: true
    description: "Idea category (Sample ideas, etc.)"
  
  - id: "customfield_14376"
    name: "Impact"
    type: "number"
    required: true
    description: "RICE Impact score"
  
  - id: "customfield_14379"
    name: "Reach"
    type: "number"
    required: true
    description: "RICE Reach score"
  
  - id: "customfield_14386"
    name: "Value"
    type: "number"
    required: true
    description: "RICE Value score"
  
  - id: "customfield_14387"
    name: "Effort"
    type: "number"
    required: true
    description: "RICE Effort score (story points)"
  
  - id: "customfield_14389"
    name: "Confidence"
    type: "number"
    required: true
    description: "RICE Confidence percentage"
  
  - id: "customfield_14388"
    name: "Idea Short Description"
    type: "text"
    required: false
    description: "Brief idea summary"

